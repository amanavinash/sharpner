
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Document</title>
</head>
<body> 
<form onsubmit="aman(event)">
 <label> Name</label>
<input id='name' type="text" name="name">
<label>EmailId </label>
<input id='emailId' type="text" name="emailId"> 
 <label> Phonenumber</label>
 <input id='phonenumber' type="tel" name="phonenumber">
 </select>
 <button> summit</button>
</form>
<ul id="listOfUsers"></ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.2/axios.min.js"></script>
<script>
   function aman(event) {
       event.preventDefault();
       const name = event.target.name.value;
       const email = event.target.emailId.value;
       const phonenumber = event.target.phonenumber.value;
       
   const obj = {
           name,
           email,
           phonenumber
       }
       axios.post("http://localhost:3000/user/add-user",obj)
       
           .then((response) => {

               showNewUserOnScreen(response.data.newUserDetails)
               console.log("aman",response.data.newUserDetails)
           })
           .catch((err) => {
               document.body.innerHTML = document.body.innerHTML + 
               console.log(err)
           });
   }

   window.addEventListener("DOMContentLoaded", () => {
    
       axios.get("http://localhost:3000/user/get-user")

           .then((response) => {
            
               for (var i = 0; i < response.data.allUsers.length; i++) {
                   showNewUserOnScreen(response.data.allUsers[i])
               }
           })
           .catch((error) => {
               console.log(error)
           });
   })
   function showNewUserOnScreen(user) {
       document.getElementById('name').value = '';
       document.getElementById('phonenumber').value = '';
       document.getElementById('emailId').value = '';
           const parentNode = document.getElementById('listOfUsers');
           const childHTML = `<li id=${user.id}> ${user.name}-${user.email}-${user.phonenumber}
                                    <button onclick="deleteUser('${user.id}')"> Delete </button>
                                    <button onclick="editUserDetails('${user.phonenumber}','${user.id}','${user.name}','${user.email}')">Edit  </button>

                                                            </li>`
           parentNode.innerHTML = parentNode.innerHTML + childHTML;
       }
     
function editUserDetails(phonenumber,userId, name, email){
document.getElementById('name').value = name;
document.getElementById('emailId').value = email;
document.getElementById('phonenumber').value =phonenumber;
deleteUser(userId);
}

   function deleteUser(userId) {
    
        axios.delete(`http://localhost:3000/user/delete-user/${userId}`)

           .then((response) => {
                    
                      removeUserFromScreen(userId)
                     
                  })
                  .catch((error) => {
                      console.log(error)
                  });
            

   }

   function removeUserFromScreen(userId) {
   
           const parentNode = document.getElementById('listOfUsers');
           const childNodeToBeDeleted = document.getElementById(userId);
        
           if (childNodeToBeDeleted) {
               parentNode.removeChild(childNodeToBeDeleted)
           }

     
   }


   








</script>


</body>

</html>